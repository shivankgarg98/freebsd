"Simplicity is the ultimate sophistication"
------------------------
|mac_ipacl Design Notes|
------------------------

Design Goals -
------------
1. Do we need to check the addresses per interface per vnet-jail or addresses per
   vnet-jail?
  
   The first one gives more flexibilty but increases complexity of policy table.
   The first is more prefered over the second since it gives ability to restrict
   the particular interface of a jail.

2. Another question which increses complexity here is- Should jails be allowed to
   create new interface? and, if yes, then how our module will react to the new
   interface?

   I am not sure about this one. But the new interfaces shall not affect the host
   until and unless they are connected to the host or other jail. So, they don't
   have any effect but this issue should be dealt to prevent any design flaw/bugs.

3. Another important step is to decide whether to allow all IP addresses or reject
   all IP address when the MAC module is loaded?
   
   I'm thinking to allow all address when the module is loaded and then tune it with
   a sysctl variable to disallow all. The host can then specify IP address according
   to the Policy Table.

4. The "Policy Table" may take-
   a.) JID - the jail id for the jail for which the restriction are to be applied.
   b.) Network Interface - The network interface which are allowed to set the IP
       address and/or which are not?
   c.) IP address/list of IP address which are allowed for particular interface.
   d.) Network Prefix(A range of IP address) that is allowed to the jail.
   e.) label to allow/reject? But depend on whether we started with all IP or NO IP.
   f.) 

5. 

Points
(To be kept in mind) -
--------------------
1. ioctl check calls should be kept generic. Although, currently we are only interested
   in VIMAGE JAILS, but in future might need to  extend the MAC module to host system,
   et cetera.
   So, the MAC calls should run for all cases, and checks related to jails and VNET 
   should be handled later in the Policy Module

2. ioctl in ioctl call name can be replaced with the ioctl.   

3. vnet should be checked from socket or interface and not from the thread. This means
   we'd probably have to pass one of those in the policy as well.
4. try to make modules based on sysctl
